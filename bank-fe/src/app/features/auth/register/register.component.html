<div class="register-page">
  <div class="register-card-wrapper">
    <p-card class="register-card">
      <ng-template pTemplate="header">
        <div class="card-header">
          <div class="icon-wrapper">
            <i class="pi pi-user-plus icon-user"></i>
          </div>
          <h1 class="card-title">Đăng ký tài khoản</h1>
          <p class="card-subtitle">Tạo tài khoản mới để bắt đầu</p>
        </div>
      </ng-template>

      <div class="card-content">
        <form
          [formGroup]="registerForm"
          (ngSubmit)="onSubmit()"
          class="register-form"
        >
          <!-- Row 1: Họ và tên + Email -->
          <div class="form-row">
            <div class="form-field">
              <label for="name" class="form-label">
                <i class="pi pi-user"></i>
                Họ và tên
              </label>
              <div class="input-wrapper">
                <input
                  pInputText
                  id="name"
                  formControlName="name"
                  placeholder="Nhập họ và tên"
                  class="form-input"
                  [class.error]="
                    registerForm.get('name')?.invalid &&
                    registerForm.get('name')?.touched
                  "
                />
              </div>
              @if (
                registerForm.get("name")?.invalid &&
                registerForm.get("name")?.touched
              ) {
                <div class="error-message">
                  <i class="pi pi-exclamation-triangle"></i>
                  Vui lòng nhập họ và tên
                </div>
              }
            </div>

            <div class="form-field">
              <label for="email" class="form-label">
                <i class="pi pi-envelope"></i>
                Email
              </label>
              <div class="input-wrapper">
                <input
                  pInputText
                  id="email"
                  type="email"
                  formControlName="email"
                  placeholder="Nhập email của bạn"
                  class="form-input"
                  [class.error]="
                    registerForm.get('email')?.invalid &&
                    registerForm.get('email')?.touched
                  "
                />
              </div>
              @if (
                registerForm.get("email")?.invalid &&
                registerForm.get("email")?.touched
              ) {
                <div class="error-message">
                  <i class="pi pi-exclamation-triangle"></i>
                  Vui lòng nhập email hợp lệ
                </div>
              }
            </div>
          </div>

          <!-- Row 2: Số điện thoại + Mật khẩu -->
          <div class="form-row">
            <div class="form-field">
              <label for="phone" class="form-label">
                <i class="pi pi-phone"></i>
                Số điện thoại (tùy chọn)
              </label>
              <div class="input-wrapper">
                <input
                  pInputText
                  id="phone"
                  formControlName="phone"
                  placeholder="Nhập số điện thoại (VD: 0901234567)"
                  class="form-input"
                  [class.error]="
                    registerForm.get('phone')?.invalid &&
                    registerForm.get('phone')?.touched
                  "
                />
              </div>
              @if (
                registerForm.get("phone")?.invalid &&
                registerForm.get("phone")?.touched
              ) {
                <div class="error-message">
                  <i class="pi pi-exclamation-triangle"></i>
                  Số điện thoại không đúng định dạng (VD: 0901234567, +84901234567)
                </div>
              }
            </div>

            <div class="form-field">
              <label for="password" class="form-label">
                <i class="pi pi-lock"></i>
                Mật khẩu
              </label>
              <div class="input-wrapper">
                <p-password
                  id="password"
                  formControlName="password"
                  placeholder="Nhập mật khẩu"
                  [feedback]="true"
                  [toggleMask]="true"
                  [class.error]="
                    registerForm.get('password')?.invalid &&
                    registerForm.get('password')?.touched
                  "
                >
                </p-password>
              </div>
              <div class="password-requirements">
                <i class="pi pi-info-circle"></i>
                Mật khẩu phải có ít nhất 8 ký tự, bao gồm chữ hoa, chữ thường,
                số và ký tự đặc biệt (@$!%*?&)
              </div>
              @if (
                registerForm.get("password")?.invalid &&
                registerForm.get("password")?.touched
              ) {
                <div class="error-message">
                  <i class="pi pi-exclamation-triangle"></i>
                  @if (registerForm.get("password")?.errors?.["required"]) {
                    Vui lòng nhập mật khẩu
                  } @else if (
                    registerForm.get("password")?.errors?.["minlength"]
                  ) {
                    Mật khẩu phải có ít nhất 8 ký tự
                  }                   @else if (
                    registerForm.get("password")?.errors?.["passwordComplexity"]
                  ) {
                    Mật khẩu phải có chữ hoa, chữ thường, số và ký tự đặc biệt (@$!%*?&)
                  }
                </div>
              }
            </div>
          </div>

          <!-- Submit Button -->
          <button
            type="submit"
            class="gradient-button"
            [disabled]="registerForm.invalid || isLoading"
          >
            <i class="pi pi-user-plus"></i>
            <span>Đăng ký</span>
          </button>
        </form>
      </div>

      <ng-template pTemplate="footer">
        <div class="card-footer">
          <p class="login-text">
            Đã có tài khoản?
            <a routerLink="/login" class="login-link">Đăng nhập ngay</a>
          </p>
        </div>
      </ng-template>
    </p-card>
  </div>
</div>
<p-toast></p-toast>
